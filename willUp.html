<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>我要申诉</title>
    <meta http-equiv=Content-Type content="text/html; charset=utf-8">
    <meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <link rel="stylesheet" href="zpSrc/index.css">
    <link rel="stylesheet" href="zpSrc/history.css">
    <link rel="stylesheet" type="text/css" href="zpSrc/main.css">
    <script src="zpSrc/jquery-3.0.0.min.js" type="text/javascript"></script>
    <script src="zpSrc/core.js" type="text/javascript"></script>
    <script src="zpSrc/cipher-core.js" type="text/javascript"></script>
    <script src="zpSrc/tripledes.js" type="text/javascript"></script>
    <script src="zpSrc/mode-ecb.js" type="text/javascript"></script>
    <style>
        .weixin-tip{
            display: none;
            position: fixed;
            left:0;
            top:0;
            bottom:0;
            background: rgba(0,0,0,0.8);
            filter:alpha(opacity=80);
            height: 100%;
            width: 100%;
            z-index: 100;
        }
        .weixin-tip p{
            text-align: center;
            margin-top: 10%;
            padding:0 5%;
        }
    </style>
    <script src="zpSrc/jquery-3.0.0.min.js" type="text/javascript"></script>
    <script>
      (function (win, doc) {
        var resize = 'orientationchange' in window ? 'orientationchange' : 'resize';

        function change() {
          var html = doc.documentElement;
          html.style.fontSize = doc.documentElement.clientWidth / 18 + 'px';
        }

        change();

        win.addEventListener(resize, change, false);
        win.addEventListener('load', change, false);
        doc.addEventListener('DOMContentLoaded', false);
      })(window, document);
    </script>
</head>
<body style="background-color: #FDEC02;" class="hd_ad_list pad-t-1 pad-l-half pad-r-half">
<div class="w-percent-100 h-4" style="border-bottom: 1px solid #666">
    <div style="background-color: #ffffff;" class="h-4 w-percent-100">
        <div class="dis-inline t-align-l h-4 v-align-t line-h-4" style="width:15%;"><img class="photo" src="" alt="" style="height:3rem;"></div>
        <span class="dis-inline pad-l-half font-22 w-percent-50">
            <span style="color: #666;font-size: 0.8rem" class="dis-inline font-wei h-2 line-h-3 v-align-t t-ellipsis" id="name"></span>
            <span style="color: #999;font-size: 0.6rem;" class="dis-inline h-2 line-h-2 v-align-t" id="date"></span>
        </span>
        <div class="dis-inline t-align-r h-4 line-h-4 v-align-t" style="width: 31%;text-align: center;">
            <div class="dis-inline font-21 h-3 v-align-m line-h-3"><span style="color: #999;" id="state"></span></div>
        </div>
    </div>
</div>
<!--编号、数量、原价-->
<div class="w-percent-100 h-4" >
    <div style="background-color: #ffffff;" class="h-4 w-percent-100">
        <div class="hd_ad_list w-percent-100" style="height:3.5rem;border-bottom: 1px solid #666">
            <div style="background-color: #ffffff;height:3.5rem;" class="w-percent-100">
                <div class="dis-inline t-align-c h-4 v-align-t line-h-4" style="width:30%;"><span style="font-size: 0.7rem">问题类型</span></div>
                <div class="dis-inline t-align-r h-4 line-h-4 v-align-t" style="width:65%;">
                    <div id="j-btn" class="dis-inline pad-l-1 h-3 v-align-m line-h-3">
                        <span class="font-21 theChoose" style="color: #999">请选择</span>&nbsp<span class="color-9"><img
                            src="zpSrc/img/right.png" alt="" style="width:0.6rem;height:1rem"></span></div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="hd_ad_list w-percent-100" style="height:8.5rem;">
    <div style="background-color: #ffffff;height:8.5rem;" class="w-percent-100">
        <div class="dis-inline pad-l-half t-align-l h-8 v-align-t line-h-2" style="width:95%;">
            <!--<span class="font-22">-->
            <textarea type="text" class="edit" rows="5" cols="10" maxlength="120" placeholder="添加描述" style="font-size: 0.8rem;width: 16rem;height: 8rem;padding-left: 0.4rem"></textarea>
        </div>
    </div>
</div>
<!--提交-->
<div class="dis-inline pad-t-2 h-2 w-percent-100">
    <div class="dis-inline w-percent-100 t-align-c h-2 line-h-2 v-align-t" style="border-radius:0.5rem;background-color: #A5673E;">
        <button id="toUp" style="background-color: #A5673E;border:none!important;width:6rem;height: 2rem;color:#fff;">提交</button>
    </div>
</div>
<!--温馨提示-->
<div class="dis-inline pad-t-2 w-percent-100 h-6">
    <div class="dis-inline w-percent-100 t-align-l h-4 line-h-1 v-align-t">
        <span style="color: #A5673E;" class="font-21 font-wei">温馨提示</span><br>
        <span style="color: #A5673E;font-size: 0.6rem">请如实反馈，拒绝恶意虚假信息，违者将被小秘书关进小黑屋哦！</span>
    </div>
</div>
<!--申诉打开遮罩-->
<div class="weixin-tip pad-t-5 pad-l-half pad-r-half">
    <div class="hd_ad_list w-percent-100" style="border-bottom: 1px solid #666">
        <div style="background-color: #ffffff;" class="w-percent-100">
            <div class="dis-inline pad-l-half t-align-r h-3 v-align-t line-h-4 closeQuestion" style="width:88%;"><span class="font-21">关闭</span></div>
            <!-- 问题 -->
            <div id='upQuestion'></div>
            <!--<div style="text-align: center;" class="font-22 makeSure">确定</div>-->
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="zpSrc/index.js"></script>
<script type="text/javascript" src="zpSrc/history.js"></script>
<script type="text/javascript" src="zpSrc/crypt.js"></script>
<script type="text/javascript">
  $(window).on("load",function(){
//    插值
    var record = JSON.parse(window.localStorage.getItem('oneRecord'));
    record.extractStatus === 0?record.extractStatus = '抓取娃娃失败':record.extractStatus = '抓取娃娃成功';
    $('.photo').attr('src',record.img);
    $('#name').text(record.goodsName);
    $('#date').text(record.createDate);
    $('#state').text(record.extractStatus);
    $('#number').text(record.prizeId);
    // 循环问题
    var config = JSON.parse(window.localStorage.getItem('config'));
    var upQuestion = config.appealTypeList;
    $.each(upQuestion,function(i,obj){
        $('<div class="dis-inline pad-l-half t-align-l h-3 v-align-t line-h-3" style="width:65%;">'+
        '<span class="font-21 chooseTheQuestion">'+obj.appealName+'</span></div>'+
            '<div class="dis-inline img1 question oneQuestion" data-id='+obj.appealId+' style="background-repeat:no-repeat;background-position:center center;background-size:1rem 1rem;text-align: right;width:33%;height: 3rem;line-height: 3rem;vertical-align: top;">'+
            '</div>').appendTo('#upQuestion');
    });
    $('#upQuestion .question').on('click',function(){
        $(this).toggleClass('img2');
         $('#upQuestion .question').not(this).removeClass('img2');//只能选择一项
    });
    //  选择一项
    $('.oneQuestion').click(function (e) {
      var nameQuestion = $(this).prev().text();
      $(".weixin-tip").hide();
      $('.edit').focus();//加输入光标
      $('.theChoose').text(nameQuestion);
      window.localStorage.setItem('appealId',e.currentTarget.dataset.id);
    });
    // 遮罩层
    var winHeight = $(window).height();
    $('#j-btn').click(function () {
      $(".weixin-tip").css("height", winHeight);
      $(".weixin-tip").show();
    });
    $('.closeQuestion').click(function () {
      $(".weixin-tip").hide();
    })
  })
//    提交
    $('#toUp').click(function(e){
      var shensuId = JSON.parse(window.localStorage.getItem('oneRecord')).prizeId;
      var token = JSON.parse(window.localStorage.getItem('token'));
      var json = {"customerId":token.customerId};
      json.grabRecordId = shensuId;
      json.type = JSON.parse(window.localStorage.getItem('appealId'));
      json.remark = $('.edit').val();
      var str = encryptByDES(JSON.stringify(json));
      $.post('http://wawatest.daniuyx.com/wawa/api/addAppeal',{json: str},function (res) {
          var list = JSON.parse(decryptByDES(res));
          console.log('申诉结果',list);
          if(list.state === 'ok'){
            alert('申诉成功');
            window.location.href = './index.html';
          }else{
            alert(list.msg);
          }
      })
    });
</script>
</html>